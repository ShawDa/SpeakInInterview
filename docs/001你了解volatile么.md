### 一句话总结

嗯，基本做 Java 项目都会用到这个关键字，它的作用是在多线程的条件下保证共享变量的可见性，主要用在一写多读的场景下。



#### 可见性问题

在多核系统中由于缓存的存在，各个处理器对共享数据的读写不会总是操作内存中的数据，这就会导致某个线程变量的修改对其它线程不可见。



#### 可见性保证

而 volatile 可以保证被修改的变量值立刻刷入主存中，且其后对该值的读取也是在主存中完成。可见性是通过总线的通知机制来实现：也就是当某个线程修改了变量值，那么就会标记其它CPU上的缓存失效，需要到主存读取变量；当然在未修改的情况下，如果缓存中存在变量还是直接从缓存中直接读取。



#### 指令重排序和 Happens-Before 

处于性能考量，系统和 JVM 会对执行的计算机指令进行重排序，当然也会保证重排序后在单线程上结果可靠。而 volatile 关键字在可见性之外还提供了 happens-before 保证，这样就强制性的保证了写操作 happens-before 其后的读操作。







### 附加题

####  在多线程读写变量的情况下 volatile 处理不了该怎么办了？

借助 juc 里面的原子操作类，volatile + cas

